(()=>{(async()=>{let g="en",c=new TCGdex.default(g),p=document.querySelector("#search"),C=document.querySelector("#searchBtn"),a=document.querySelector("#results"),r=document.querySelector("#detail"),$=document.querySelector("#status");function E(e,{quality:i="high",ext:t="png"}={}){var o,m,l;let n=((o=e==null?void 0:e.set)==null?void 0:o.id)||((m=e==null?void 0:e.id)==null?void 0:m.split("-")[0]),s=(e==null?void 0:e.localId)||((l=e==null?void 0:e.id)==null?void 0:l.split("-")[1]);return!n||!s?"":`https://assets.tcgdex.net/${g}/${n}/${s}/${i}.${t}`}function h(e){$&&($.textContent=e||"")}async function A(e){let{Query:i}=TCGdex,t=await c.card.list(new i().equal("name",e));if(!t||t.length===0){let n=await c.card.list(),s=e.trim().toLowerCase();t=(n||[]).filter(o=>(o.name||"").toLowerCase().includes(s)).slice(0,60)}return t||[]}function b(e){if(!a)return;if(a.innerHTML="",!e.length){a.innerHTML="<p>Keine Karten gefunden.</p>";return}let i=document.createDocumentFragment();e.forEach(t=>{var L,N,S,w,q;let n=document.createElement("div");n.className="card-item";let s=document.createElement("img");s.alt=t.name||"",s.loading="lazy",s.src=E(t,{quality:"high",ext:"png"}),s.src||(s.style.display="none");let o=document.createElement("div"),m=((L=t==null?void 0:t.set)==null?void 0:L.name)||(t==null?void 0:t.setName)||"",l=(t==null?void 0:t.localId)||(t==null?void 0:t.number)||"";o.className="card-title",o.textContent=`${t.name||"\u2014"} ${l?`(#${l})`:""}`;let u=document.createElement("div");u.className="card-meta",u.textContent=[m,t==null?void 0:t.rarity].filter(Boolean).join(" \xB7 ");let f=document.createElement("div");f.className="card-price";let y=((N=t==null?void 0:t.prices)==null?void 0:N.market)||((q=(w=(S=t==null?void 0:t.tcgplayer)==null?void 0:S.prices)==null?void 0:w.normal)==null?void 0:q.market);f.textContent=y!=null?`~ ${y.toFixed?y.toFixed(2):y} $`:"",n.addEventListener("click",()=>k(t)),n.appendChild(s),n.appendChild(o),n.appendChild(u),f.textContent&&n.appendChild(f),i.appendChild(n)}),a.appendChild(i)}function k(e){var m;if(!r)return;r.innerHTML="";let i=document.createElement("h2"),t=((m=e==null?void 0:e.set)==null?void 0:m.name)||"";i.textContent=`${e.name||"\u2014"} ${e!=null&&e.localId?`(#${e.localId})`:""}`;let n=document.createElement("img");n.alt=e.name||"",n.loading="lazy",n.src=E(e,{quality:"high",ext:"png"});let s=document.createElement("div");s.className="card-detail";let o=[["Set",t],["Rarity",e==null?void 0:e.rarity],["Type(s)",((e==null?void 0:e.types)||[]).join(", ")],["HP",e==null?void 0:e.hp],["Illustrator",e==null?void 0:e.illustrator]].filter(([,l])=>l&&(Array.isArray(l)&&l.length||!Array.isArray(l)));s.innerHTML=`
      <ul>
        ${o.map(([l,u])=>`<li><strong>${l}:</strong> ${Array.isArray(u)?u.join(", "):u}</li>`).join("")}
      </ul>
    `,r.appendChild(i),r.appendChild(n),r.appendChild(s),r.scrollIntoView({behavior:"smooth",block:"start"})}async function x(){let e=((p==null?void 0:p.value)||"").trim();if(!e){h("Bitte einen Suchbegriff eingeben.");return}h("Suche l\xE4uft \u2026");try{let i=await A(e);b(i),h(i.length?`${i.length} Karten gefunden.`:"Nichts gefunden.")}catch(i){console.error(i),h("Fehler beim Laden der Karten.")}}C&&C.addEventListener("click",x),p&&p.addEventListener("keydown",e=>{e.key==="Enter"&&x()})})();})();
